---
// Theme toggle - switches between light and dark themes
---

<button
  id="theme-toggle"
  type="button"
  aria-label="Toggle theme"
  title="Toggle theme (t)"
>
  <span class="theme-icon" aria-hidden="true"></span>
</button>

<style>
  button {
    background: none;
    border: 1px solid var(--border);
    color: var(--muted);
    cursor: pointer;
    padding: 0.25rem 0.5rem;
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.85rem;
    transition:
      color 0.2s ease,
      border-color 0.2s ease;
  }

  button:hover {
    color: var(--accent);
    border-color: var(--accent);
  }

  button:focus-visible {
    outline: 2px solid var(--accent);
    outline-offset: 2px;
  }
</style>

<script>
  const toggle = document.getElementById('theme-toggle')
  const icon = toggle?.querySelector('.theme-icon')

  function getTheme(): string {
    const stored = localStorage.getItem('theme')
    if (stored) return stored
    return window.matchMedia('(prefers-color-scheme: light)').matches
      ? 'light'
      : 'dark'
  }

  function setTheme(theme: string) {
    document.documentElement.setAttribute('data-theme', theme)
    localStorage.setItem('theme', theme)
    updateIcon(theme)
  }

  function updateIcon(theme: string) {
    if (icon) {
      icon.textContent = theme === 'dark' ? '[ light ]' : '[ dark ]'
    }
  }

  // Initialize
  const currentTheme = getTheme()
  setTheme(currentTheme)

  toggle?.addEventListener('click', () => {
    const current = document.documentElement.getAttribute('data-theme')
    setTheme(current === 'dark' ? 'light' : 'dark')
  })
</script>

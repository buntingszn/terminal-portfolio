---
import Base from '@layouts/Base.astro'
import Nav from '@components/Nav.astro'
import StatusBar from '@components/StatusBar.astro'
import GradientHeading from '@components/GradientHeading.astro'
import { getMeta, getWork } from '../lib/data'

const meta = getMeta()
const { projects } = getWork()
const featured = projects.filter((p) => p.featured)
const others = projects.filter((p) => !p.featured)
const sorted = [...featured, ...others]
---

<Base title={`Work | ${meta.name}`} description="Projects and work">
  <Nav current="work" />

  <div class="page-content">
  <GradientHeading text="Projects" />

  <section class="project-list" aria-label="Projects">
    {
      sorted.map((project) => (
        <div class="project">
          <div class="project-header">
            <span class="project-title">
              {project.featured && (
                <span class="featured-star" aria-label="Featured">
                  ★{' '}
                </span>
              )}
              {project.title}
            </span>
            <span class="tags">
              {project.tags.map((tag) => (
                <span class="tag">{tag}</span>
              ))}
            </span>
          </div>
          <div class="project-body">
            <p class="description">{project.description}</p>
            <div class="project-links">
              {project.url && (
                <a href={project.url} target="_blank" rel="noopener">
                  [visit]
                </a>
              )}
              {project.repo && (
                <a href={project.repo} target="_blank" rel="noopener">
                  [repo]
                </a>
              )}
            </div>
          </div>
        </div>
      ))
    }
  </section>
  </div>

  <StatusBar center="j/k scroll · 1-4 nav · ? help" />
</Base>

<style>
  :global(.gradient-heading) {
    font-size: 1.5rem;
    margin-bottom: 1.5rem;
  }

  .project-list {
    display: flex;
    flex-direction: column;
    gap: 1.25rem;
  }

  .project {
    padding-bottom: 1.25rem;
    border-bottom: 1px solid var(--border);
  }

  .project:last-child {
    border-bottom: none;
    padding-bottom: 0;
  }

  .project-header {
    display: flex;
    justify-content: space-between;
    align-items: baseline;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-bottom: 0.4rem;
  }

  .project-title {
    color: var(--accent);
    font-weight: 700;
    font-size: 1rem;
  }

  .featured-star {
    color: var(--accent);
  }

  .tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
  }

  .tag {
    color: var(--muted);
    font-size: 0.8rem;
  }

  .project-body {
    padding-left: 1.5rem;
  }

  .description {
    margin-bottom: 0.5rem;
    line-height: 1.6;
  }

  .project-links {
    display: flex;
    gap: 1rem;
  }

  .project-links a {
    color: var(--accent);
    text-decoration: none;
    font-size: 0.9rem;
    transition: color 0.2s ease;
  }

  .project-links a:hover {
    color: var(--fg);
  }

  .project-links a:focus-visible {
    outline: 2px solid var(--accent);
    outline-offset: 2px;
  }

  @media (max-width: 480px) {
    .project-header {
      flex-direction: column;
      gap: 0.25rem;
    }

    .project-body {
      padding-left: 0;
    }
  }
</style>

---
import Base from '@layouts/Base.astro'
import Nav from '@components/Nav.astro'
import StatusBar from '@components/StatusBar.astro'
import AsciiBox from '@components/AsciiBox.astro'
import { getMeta, getWork } from '../lib/data'

const meta = getMeta()
const { projects } = getWork()
const featured = projects.filter((p) => p.featured)
const others = projects.filter((p) => !p.featured)
---

<Base title={`Work | ${meta.name}`} description="Projects and work">
  <Nav current="work" />

  <h1>Projects</h1>

  {
    featured.length > 0 && (
      <section class="featured" aria-label="Featured projects">
        <h2 class="section-heading">Featured</h2>
        {featured.map((project) => (
          <AsciiBox title={project.title}>
            <p>{project.description}</p>
            <div class="tags">
              {project.tags.map((tag) => (
                <span class="tag">{tag}</span>
              ))}
            </div>
            <div class="project-links">
              {project.url && (
                <a href={project.url} target="_blank" rel="noopener">
                  [visit]
                </a>
              )}
              {project.repo && (
                <a href={project.repo} target="_blank" rel="noopener">
                  [repo]
                </a>
              )}
            </div>
          </AsciiBox>
        ))}
      </section>
    )
  }

  {
    others.length > 0 && (
      <section class="other-projects" aria-label="Other projects">
        <h2 class="section-heading">Other</h2>
        {others.map((project) => (
          <AsciiBox title={project.title}>
            <p>{project.description}</p>
            <div class="tags">
              {project.tags.map((tag) => (
                <span class="tag">{tag}</span>
              ))}
            </div>
            <div class="project-links">
              {project.url && (
                <a href={project.url} target="_blank" rel="noopener">
                  [visit]
                </a>
              )}
              {project.repo && (
                <a href={project.repo} target="_blank" rel="noopener">
                  [repo]
                </a>
              )}
            </div>
          </AsciiBox>
        ))}
      </section>
    )
  }

  <StatusBar
    left="~/work"
    center="j/k scroll · 1-4 nav · ? help"
    right="WORK"
  />
</Base>

<style>
  h1 {
    font-size: 1.5rem;
    margin-bottom: 1.5rem;
    color: var(--fg);
  }

  .section-heading {
    font-size: 1rem;
    color: var(--muted);
    margin-bottom: 1rem;
    font-weight: 400;
  }

  section {
    margin-bottom: 2rem;
  }

  section :global(.ascii-box) {
    margin-bottom: 1rem;
  }

  p {
    margin-bottom: 0.75rem;
    line-height: 1.6;
  }

  .tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-bottom: 0.5rem;
  }

  .tag {
    color: var(--muted);
    font-size: 0.8rem;
  }

  .project-links {
    display: flex;
    gap: 1rem;
  }

  .project-links a {
    color: var(--accent);
    text-decoration: none;
    font-size: 0.9rem;
    transition: color 0.2s ease;
  }

  .project-links a:hover {
    color: var(--fg);
  }

  .project-links a:focus-visible {
    outline: 2px solid var(--accent);
    outline-offset: 2px;
  }
</style>

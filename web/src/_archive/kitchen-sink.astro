---
import Base from '@layouts/Base.astro'
import Nav from '@components/Nav.astro'
import StatusBar from '@components/StatusBar.astro'
import { getMeta, getCv } from '../lib/data'

const meta = getMeta()
const cv = getCv()

/** Bold text before the first comma or semicolon in a bullet. */
function splitBullet(text: string): { bold: string; rest: string } {
  const match = text.match(/^([^,;]+)([,;].*)$/)
  if (!match) return { bold: text, rest: '' }
  return { bold: match[1], rest: match[2] }
}
---

<Base title={`Kitchen Sink | ${meta.name}`} description="CV readability experiments">
  <Nav current="" />

  <div class="page-content">
    <div class="ks-intro">
      <p class="ks-title">CV Readability Kitchen Sink</p>
      <p class="ks-subtitle">12 TUI-inspired visual treatments applied to real CV data. Cherry-pick the best ones.</p>
    </div>

    {/* ── 1. Reverse Video Section Headers ── */}
    <div class="demo">
      <div class="demo-label">1. Reverse Video Section Headers</div>
      <div class="demo-content">
        <div class="rv-divider" role="separator">
          <span class="rv-label">&nbsp; EXPERIENCE &nbsp;</span>
        </div>
        {cv.experience.map((job) => (
          <div class="entry">
            <div class="entry-header">
              <span>
                <span class="key">{job.role}</span>
                <span class="muted"> @ {job.company}</span>
              </span>
              <span class="muted">{job.start} &ndash; {job.end}</span>
            </div>
            <ul>
              {job.bullets.map((b) => <li>{b}</li>)}
            </ul>
          </div>
        ))}
      </div>
    </div>

    {/* ── 2. Box-Drawing Frames for Entries ── */}
    <div class="demo">
      <div class="demo-label">2. Box-Drawing Frames for Entries</div>
      <div class="demo-content">
        <div class="divider" role="separator"><span>experience</span></div>
        {cv.experience.map((job) => (
          <div class="box-entry">
            <div class="box-top">
              <span>┌─ {job.role} @ {job.company} ──── {job.start}–{job.end} ─┐</span>
            </div>
            <div class="box-body">
              {job.bullets.map((b) => (
                <div class="box-line">│ ▸ {b}</div>
              ))}
            </div>
            <div class="box-bottom">└{'─'.repeat(60)}┘</div>
          </div>
        ))}
      </div>
    </div>

    {/* ── 3. Tree-Style Bullets ── */}
    <div class="demo">
      <div class="demo-label">3. Tree-Style Bullets</div>
      <div class="demo-content">
        <div class="divider" role="separator"><span>experience</span></div>
        {cv.experience.map((job) => (
          <div class="entry">
            <div class="entry-header">
              <span>
                <span class="key">{job.role}</span>
                <span class="muted"> @ {job.company}</span>
              </span>
              <span class="muted">{job.start} &ndash; {job.end}</span>
            </div>
            <div class="tree-list">
              {job.bullets.map((b, i) => (
                <div class="tree-item">
                  <span class="tree-char">{i < job.bullets.length - 1 ? '├─' : '└─'}</span>
                  <span>{b}</span>
                </div>
              ))}
            </div>
          </div>
        ))}
      </div>
    </div>

    {/* ── 4. Italic for Secondary Text ── */}
    <div class="demo">
      <div class="demo-label">4. Italic for Secondary Text</div>
      <div class="demo-content">
        <p class="italic-summary">{cv.summary}</p>
        <div class="divider" role="separator"><span>experience</span></div>
        {cv.experience.map((job) => (
          <div class="entry">
            <div class="entry-header">
              <span>
                <span class="key">{job.role}</span>
                <span class="italic-secondary"> @ {job.company}</span>
              </span>
              <span class="italic-secondary">{job.start} &ndash; {job.end}</span>
            </div>
            <ul>
              {job.bullets.map((b) => <li>{b}</li>)}
            </ul>
          </div>
        ))}
      </div>
    </div>

    {/* ── 5. Underline for Role Titles ── */}
    <div class="demo">
      <div class="demo-label">5. Underline for Role Titles</div>
      <div class="demo-content">
        <div class="divider" role="separator"><span>experience</span></div>
        {cv.experience.map((job) => (
          <div class="entry">
            <div class="entry-header">
              <span>
                <span class="ul-role">{job.role}</span>
                <span class="muted"> @ {job.company}</span>
              </span>
              <span class="muted">{job.start} &ndash; {job.end}</span>
            </div>
            <ul>
              {job.bullets.map((b) => <li>{b}</li>)}
            </ul>
          </div>
        ))}
        <div class="divider" role="separator"><span>education</span></div>
        {cv.education.map((edu) => (
          <div class="edu-entry">
            <p>
              <span class="ul-role">{edu.degree}</span>
              <span class="muted"> @ {edu.institution}</span>
            </p>
            <p class="muted">{edu.year}</p>
          </div>
        ))}
      </div>
    </div>

    {/* ── 6. Dot Leaders for Skills ── */}
    <div class="demo">
      <div class="demo-label">6. Dot Leaders for Skills</div>
      <div class="demo-content">
        <div class="divider" role="separator"><span>skills</span></div>
        {cv.skills.map((group) => (
          <div class="dot-leader">
            <span class="dot-label key">{group.category}</span>
            <span class="dot-fill"></span>
            <span class="dot-value">{group.items.join(', ')}</span>
          </div>
        ))}
      </div>
    </div>

    {/* ── 7. Inline Code Tags for Tech Terms ── */}
    <div class="demo">
      <div class="demo-label">7. Inline Code Tags for Tech Terms</div>
      <div class="demo-content demo-code-tags">
        <div class="divider" role="separator"><span>experience</span></div>
        {cv.experience.map((job) => (
          <div class="entry">
            <div class="entry-header">
              <span>
                <span class="key">{job.role}</span>
                <span class="muted"> @ {job.company}</span>
              </span>
              <span class="muted">{job.start} &ndash; {job.end}</span>
            </div>
            <ul>
              {job.bullets.map((b) => (
                <li set:html={
                  b.replace(
                    /\b(TypeScript|React|Next\.js|Hono|Astro|Go|Shell|Ruby on Rails|Elixir|ComfyUI|Flux|LoRA|CI\/CD|CMS|CMMS|RAG|LLM|SSH|AI)\b/g,
                    '<code>$1</code>'
                  )
                } />
              ))}
            </ul>
          </div>
        ))}
      </div>
    </div>

    {/* ── 8. Bold First Clause in Bullets ── */}
    <div class="demo">
      <div class="demo-label">8. Bold First Clause in Bullets</div>
      <div class="demo-content">
        <div class="divider" role="separator"><span>experience</span></div>
        {cv.experience.map((job) => (
          <div class="entry">
            <div class="entry-header">
              <span>
                <span class="key">{job.role}</span>
                <span class="muted"> @ {job.company}</span>
              </span>
              <span class="muted">{job.start} &ndash; {job.end}</span>
            </div>
            <ul>
              {job.bullets.map((b) => {
                const { bold, rest } = splitBullet(b)
                return (
                  <li>
                    <strong>{bold}</strong>{rest}
                  </li>
                )
              })}
            </ul>
          </div>
        ))}
      </div>
    </div>

    {/* ── 9. Left Border Indent Blocks ── */}
    <div class="demo">
      <div class="demo-label">9. Left Border Indent Blocks</div>
      <div class="demo-content">
        <div class="divider" role="separator"><span>experience</span></div>
        {cv.experience.map((job) => (
          <div class="entry">
            <div class="entry-header">
              <span>
                <span class="key">{job.role}</span>
                <span class="muted"> @ {job.company}</span>
              </span>
              <span class="muted">{job.start} &ndash; {job.end}</span>
            </div>
            <ul class="left-border-list">
              {job.bullets.map((b) => <li>{b}</li>)}
            </ul>
          </div>
        ))}
      </div>
    </div>

    {/* ── 10. Two-Column Skills Grid ── */}
    <div class="demo">
      <div class="demo-label">10. Two-Column Skills Grid</div>
      <div class="demo-content">
        <div class="divider" role="separator"><span>skills</span></div>
        <div class="skills-grid">
          {cv.skills.map((group) => (
            <p class="skill-line">
              <span class="key">{group.category}</span>: {group.items.join(', ')}
            </p>
          ))}
        </div>
      </div>
    </div>

    {/* ── 11. Accent Dates (Right-Aligned) ── */}
    <div class="demo">
      <div class="demo-label">11. Accent Dates (Right-Aligned)</div>
      <div class="demo-content">
        <div class="divider" role="separator"><span>experience</span></div>
        {cv.experience.map((job) => (
          <div class="entry">
            <div class="entry-header">
              <span>
                <span class="key">{job.role}</span>
                <span class="muted"> @ {job.company}</span>
              </span>
              <span class="accent-date">{job.start} &ndash; {job.end}</span>
            </div>
            <ul>
              {job.bullets.map((b) => <li>{b}</li>)}
            </ul>
          </div>
        ))}
      </div>
    </div>

    {/* ── 12. Pipe-Separated Header ── */}
    <div class="demo">
      <div class="demo-label">12. Pipe-Separated Header</div>
      <div class="demo-content">
        <div class="divider" role="separator"><span>experience</span></div>
        {cv.experience.map((job) => (
          <div class="entry">
            <div class="pipe-header">
              <span class="key">{job.role}</span>
              <span class="pipe-sep">│</span>
              <span>{job.company}</span>
              <span class="pipe-sep">│</span>
              <span class="muted">{job.start} – {job.end}</span>
            </div>
            <ul>
              {job.bullets.map((b) => <li>{b}</li>)}
            </ul>
          </div>
        ))}
      </div>
    </div>

  </div>

  <StatusBar center="←/→ nav · ? help" />
</Base>

<style>
  /* ── Kitchen Sink Page ── */
  .ks-intro {
    margin-bottom: 1.5rem;
  }

  .ks-title {
    font-weight: 700;
    color: var(--accent);
    margin-bottom: 0.25rem;
  }

  .ks-subtitle {
    color: var(--muted);
    margin-bottom: 0;
  }

  /* ── Demo Container ── */
  .demo {
    margin-bottom: 2.5rem;
  }

  .demo-label {
    color: var(--muted);
    text-transform: uppercase;
    letter-spacing: 0.08em;
    font-variant: small-caps;
    margin-bottom: 0.75rem;
    padding-bottom: 0.25rem;
    border-bottom: 1px solid var(--border);
  }

  .demo-content {
    padding: 0;
  }

  /* ── Shared styles (reused from cv.astro) ── */
  .key {
    color: var(--accent);
    font-weight: 700;
  }

  .muted {
    color: var(--muted);
  }

  .divider {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: var(--border);
    margin: 1.25rem 0;
    user-select: none;
  }

  .divider::before,
  .divider::after {
    content: '';
    flex: 1;
    border-top: 1px solid var(--border);
  }

  .divider span {
    color: var(--accent);
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    white-space: nowrap;
  }

  .entry {
    margin-bottom: 1.25rem;
  }

  .entry:last-of-type {
    margin-bottom: 0;
  }

  .entry-header {
    display: flex;
    justify-content: space-between;
    align-items: baseline;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-bottom: 0.25rem;
  }

  .entry ul {
    list-style: none;
    padding-left: 1.5rem;
    margin-bottom: 0;
  }

  .entry li::before {
    content: '- ';
  }

  .entry li {
    color: var(--fg);
    margin-bottom: 0.15rem;
  }

  .skill-line {
    margin-bottom: 0.35rem;
    line-height: 1.6;
  }

  .edu-entry {
    margin-bottom: 0.5rem;
  }

  .edu-entry:last-of-type {
    margin-bottom: 0;
  }

  .edu-entry p {
    margin-bottom: 0;
  }

  /* ── 1. Reverse Video ── */
  .rv-divider {
    margin: 1.25rem 0;
    user-select: none;
  }

  .rv-label {
    display: inline-block;
    background: var(--accent);
    color: var(--bg);
    font-weight: 700;
    letter-spacing: 0.1em;
    padding: 1px 0;
  }

  /* ── 2. Box-Drawing Frames ── */
  .box-entry {
    margin-bottom: 1.25rem;
    color: var(--fg);
  }

  .box-entry:last-of-type {
    margin-bottom: 0;
  }

  .box-top {
    color: var(--border);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .box-body {
    color: var(--fg);
  }

  .box-line {
    color: var(--fg);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .box-line::first-letter {
    color: var(--border);
  }

  .box-bottom {
    color: var(--border);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  /* ── 3. Tree-Style Bullets ── */
  .tree-list {
    padding-left: 1rem;
  }

  .tree-item {
    display: flex;
    gap: 0.5rem;
    margin-bottom: 0.15rem;
  }

  .tree-char {
    color: var(--border);
    flex-shrink: 0;
  }

  /* ── 4. Italic Secondary Text ── */
  .italic-summary {
    font-style: italic;
    color: var(--fg);
    line-height: 1.6;
    margin-bottom: 0;
  }

  .italic-secondary {
    font-style: italic;
    color: var(--muted);
  }

  /* ── 5. Underline Role Titles ── */
  .ul-role {
    color: var(--accent);
    font-weight: 700;
    text-decoration: underline;
    text-underline-offset: 3px;
    text-decoration-color: var(--accent);
  }

  /* ── 6. Dot Leaders ── */
  .dot-leader {
    display: flex;
    align-items: baseline;
    gap: 0.25rem;
    margin-bottom: 0.35rem;
    line-height: 1.6;
  }

  .dot-label {
    flex-shrink: 0;
  }

  .dot-fill {
    flex: 1;
    overflow: hidden;
    white-space: nowrap;
  }

  .dot-fill::after {
    content: ' ·  ·  ·  ·  ·  ·  ·  ·  ·  ·  ·  ·  ·  ·  ·  ·  ·  ·  ·  ·  ·  ·  ·  ·  ·  ·  ·  ·  ·  ·  ·  ·  ·  ·  ·  · ';
    color: var(--muted);
  }

  .dot-value {
    flex-shrink: 0;
    max-width: 60%;
  }

  /* ── 7. Inline Code Tags ── */
  .demo-code-tags code {
    background: var(--border);
    padding: 1px 4px;
    border-radius: 2px;
    font-size: inherit;
    font-family: inherit;
  }

  /* ── 8. Bold First Clause (uses <strong> in markup) ── */

  /* ── 9. Left Border Indent ── */
  .left-border-list {
    border-left: 2px solid var(--border);
    padding-left: 1rem !important;
    margin-left: 0.5rem;
  }

  /* ── 10. Two-Column Skills Grid ── */
  .skills-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 0.25rem 2rem;
  }

  /* ── 11. Accent Dates ── */
  .accent-date {
    color: var(--accent);
    font-weight: 700;
  }

  /* ── 12. Pipe-Separated Header ── */
  .pipe-header {
    display: flex;
    align-items: baseline;
    gap: 0.5rem;
    margin-bottom: 0.25rem;
    flex-wrap: wrap;
  }

  .pipe-sep {
    color: var(--border);
  }

  /* ── Responsive ── */
  @media (max-width: 640px) {
    .entry-header {
      flex-direction: column;
      gap: 0.15rem;
    }

    .pipe-header {
      flex-direction: column;
      gap: 0.15rem;
    }

    .pipe-sep {
      display: none;
    }

    .skills-grid {
      grid-template-columns: 1fr;
    }

    .dot-leader {
      flex-direction: column;
      gap: 0;
    }

    .dot-fill {
      display: none;
    }

    .dot-value {
      max-width: 100%;
      padding-left: 1rem;
    }
  }
</style>
